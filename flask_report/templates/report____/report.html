{% extends "report____/layout.html" %}

{% block report____title_block %}
  {{ report.name }}
{% endblock %}

{% block report____customized_head_block %}
<link rel="stylesheet" type="text/css" href="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/css/jquery.dataTables.css">
<script type="text/javascript" charset="utf8" src="http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.4/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="{{ url_for('report____.static', filename='js/DT_bootstrap.js') }}"></script>
<script type="text/javascript">
  $.extend( $.fn.dataTableExt.oStdClasses, {
      "sWrapper": "dataTables_wrapper form-inline"
  });
  $(function () {
      $("#report").dataTable({
        "oLanguage": {
            "sSearch": '{{ _("Search") }}' + " :",
            "sLengthMenu": '{{ _("Display _MENU_ records per page") }}',
            "sZeroRecords": '{{ _("Nothing found - sorry") }}',
            "sInfo": '{{ _("Showing _START_ to _END_ of _TOTAL_ records") }}',
            "sInfoEmpty": '{{ _("Showing 0 to 0 of 0 records") }}',
            "sInfoFiltered": "(" + '{{ _("filtered from _MAX_ total records") }}' + ")",
            'oPaginate': {
              "sPrevious": '{{ _("Previous") }} ',
              "sNext": '{{ _("Next") }}',
              "sFirst": '{{ _("First") }}',
              'sLast': '{{ _("Last") }}',
              },
            },
        "sDom": "<'row'<'span6'l><'span6'f>r>t<'row'<'span6'i><'span6'p>>",
        "iDisplayLength": 25,
        });
      $("#detail").on('shown', function () {
        $('a[data-target="#detail"]').text("{{ _('hide detail') }}" + " <<");
        });
      $("#detail").on('hidden', function () {
        $('a[data-target="#detail"]').text("{{ _('show detail') }}" + " >>");
        });
      });
</script>
{% endblock %}

{% block body %}
<div class="container">
<div class="alert alert-info">
  <h1>
  <span>
    {{report.name}}
    <small>
      <a href="#" data-toggle="collapse" data-target="#detail" class='muted'>{{ _('show detail') }} >></a>
    </small>
  </span>
  </h1>
  <div id="detail" class="collapse">
  <p><small>{{ report.description +"<br>"|safe if report.description else "" }}{{ _('created by "%(creator)s" at %(create_time)s, using data set <span title="%(data_set_description)s">"%(data_set)s"</span>, ',
    creator=report.creator, create_time=report.creat_time,
    data_set_description=report.data_set.description,
    data_set=report.data_set.name) }}
    {% if report.order_by %}
      {{ _('order by "%(order_by)s" %(order)s',
        order_by=report.order_by.name, 
        order=_('descendingly') if report.order_by.descend else _('ascendingly'))
      }}
    {% endif %}; 
    {{ _('filter conditions are: ') }}
  </small></p>
  <ul>
    {% if report.filters %}
    {% for name, value in report.filters.items() %}
    <li>
    <small>
      <Strong>{{ name }}</Strong> - {{ value }}
    </small>
    </li>
    {% endfor %}
    {% endif %}
  </ul>
  <p>
    <small>
      {{ _("the customized filter condition is: ") }} 
    </small>
  </p>
  <p>
    {{ customized_filter_condition|safe }}
  </p>
  <p><small></small></p>
</div>
</div>
<hr />
<div>
{{ html_report|safe }}
</div>
<hr />

<span class='span-12'>
  {{ _("download as: ")}}
  <div class="btn-group pagination-centered">
    <a href="{{ url_for('.report_pdf', id_=report.id_) }}" class="btn btn-primary btn-info">PDF</a>
    <a href="{{ url_for('.report_csv', id_=report.id_) }}" class="btn btn-primary btn-info">CSV</a>
    <a href="{{ url_for('.report_txt', id_=report.id_) }}" class="btn btn-primary btn-info">TXT</a>
  </div>
</span>
<div class="pagination-centered span12">
  <a href="{{ url_for('.report_list') }}" class="btn btn-primary btn-large">{{ _('BACK') }}</a>
  <a href="" class="btn btn-primary btn-large">{{ _('EDIT') }}</a>
  <a href="" class="btn btn-primary btn-large">{{ _('REFRESH') }}</a>
</div>
</div>
{% endblock %}
